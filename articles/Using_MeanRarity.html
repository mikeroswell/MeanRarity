<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MeanRarity: An R package to facilitate estimation and visualization of Hill diversity • MeanRarity</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="MeanRarity: An R package to facilitate estimation and visualization of Hill diversity">
<meta property="og:description" content="MeanRarity">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-018C47WP3Y"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-018C47WP3Y');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MeanRarity</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1.0005</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Estimating_Mean_Rarity.html">Estimating mean rarity</a>
    </li>
    <li>
      <a href="../articles/Gods_estimator.html">Gods estimator of mean rarity</a>
    </li>
    <li>
      <a href="../articles/Using_MeanRarity.html">MeanRarity: An R package to facilitate estimation and visualization of Hill diversity</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>MeanRarity: An R package to facilitate
estimation and visualization of Hill diversity</h1>
            
      
      
      <div class="hidden name"><code>Using_MeanRarity.Rmd</code></div>

    </div>

    
    
<!-- need to explore output formats for size, speed, and features (e.g. eqn
numbers) -->
<!-- also see prettydoc::html_pretty which might solve the equation numbering
issues -->
<!-- https://bookdown.org/yihui/rmarkdown/prettydoc.html -->
<!-- consider "aritcle" rather than vignette:
https://r-pkgs.org/vignettes.html#sec-vignettes-article -->
<!-- Application: Short (no more than 3000-4000 words total) descriptions of new
software that are intended to describe and promote the software as well as act
as a citeable resource for developers. Application papers are made free to
access for one month after being assigned to an issue in order to encourage
uptake of the methodologies they describe. Uploading a package to a site such as
CRAN or sourceforge in advance is not considered prior publication and will not
hinder your submission to MEE. View some example Applications here:
https://besjournals.onlinelibrary.wiley.com/hub/journal/2041210X/features/applicationpapers
-->
<!-- also see https://www.jstatsoft.org/authors -->
<div class="section level2">
<h2 id="abstract">ABSTRACT<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<!-- 350 words max, now 355 -->
<!-- 1. context for and purpose of the work -->
<!-- 2. approach and methods -->
<!-- 3. key results -->
<!-- 4. conclusions and the wider implications -->
<ol style="list-style-type: decimal">
<li><p>Ecologists must choose between diversity metrics that differ in
interpretation, as well as numerical and statistical properties, to
detect, describe, and predict biodiversity change. Hill diversities, a
family that unites popular metrics, including Richness, Shannon’s
entropy, and Simpson’s concentration, with a single equation, simplify
this choice. The scaling parameter accommodates disparate diversity
concepts by placing greater emphasis on common or rare types, and the
resulting diversities use a common currency, the “effective” number of
types <!-- don't like two meanings of common here!
Also, is "types" good enough?-->. Even with this elegant unification,
users must select values for the Hill diversity scaling parameter, and
interpret the ecological significance of the resulting diversity.
Concrete metaphors for the Hill diversity scaling, as well as guidance
about the numerical and statistical properties of Hill diversity
estimates, could facilitate that selection.</p></li>
<li><p>We present the <code>R</code> package
<strong>MeanRarity</strong>, which enables estimating and visualizing
Hill diversity (aka “Hill numbers”) in terms of the average species
rarity, i.e the reciprocal of relative abundance. With
<strong>MeanRarity</strong>, users can compute mean rarity, generate
plots to visualize species abundance distributions and their average
rarity, and simulate abundance distributions with known diversity. To
illustrate the use of <strong>MeanRarity</strong>, we simulate species
abundance distributions that vary in shape but not richness, and
estimate assemblage diversity based on random samples from these
distributions. We investigate how the bias and variability of Hill
diversity estimates depend on the Hill diversity scaling parameter,
features of the abundance distribution such as evenness, and sampling
intensity.</p></li>
<li><p>Our simulations reveal that Hill-Simpson diversity can be highly
variable. Furthermore, the asymptotic estimator for Hill-Simpson
diversity exhibited greater bias at low sample sizes than the asymptotic
estimator for Hill diversities with intermediate scaling parameter
values (including Hill-Shannon diversity). As previously reported,
however, the bias is negligible for the asymptotic estimates for all
Hill diversities with a scaling parameter less than about 0.25, once
samples sizes were relatively large, for all species abundance
distributions tested.</p></li>
<li><p><strong>MeanRarity</strong> provides tools to students,
researchers, and biostatisticians to understand and investigate Hill
diversity metrics. Fixing diversity values, <em>a priori</em>, in
simulated species abundance distributions enables replicable, targeted
testing of numerical and statistical properties of Hill diversities and
their estimators. Our simulations reveal that for both sample Hill
diversities and asymptotic Hill diversity estimates, lower bias and
variability may be possible for Hill diversities between Hill-Simpson
diversity and richness for small, incomplete samples.</p></li>
</ol>
<!-- major question is whether we advocate using this package to ecologists who
just want to measure diversity. I am not sure, b/c it is thin and redundant rel. 
to Chao et al. packages. --><!-- minor question: is this transparent enough to people not in my head? Like, 
will readers have any idea what "Hill-Shannon" means? Or "sample diversity"? -->
</div>
<div class="section level2">
<h2 id="key-words">KEY WORDS<a class="anchor" aria-label="anchor" href="#key-words"></a>
</h2>
<!-- up to 8 -->
<p>Hill numbers; biodiversity; sampling; species abundance distribution;
R package; rarity; evenness; precision</p>
</div>
<div class="section level2">
<h2 id="introduction">INTRODUCTION<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Biodiversity underpins human existence and drives the character and
function of earth’s ecosystems. At the same time, biodiversity is
shifting and arguably, declining, at an unprecedented rate due to
anthropogenic global change. Yet, detecting and describing this change
means choosing just what to measure, and how. Ecologists are faced with
a dazzling array of choices.</p>
<p>Increasingly, Hill diversity or “Hill numbers”, a unified family of
diversity measures that includes variants of classical metrics such as
species richness and the Shannon and Simpson indices, have been put
forward as the appropriate metrics for biodiversity quantification <span class="citation">(Roswell, Dushoff, and Winfree 2021; Chao et al. 2014;
Jost 2006; Sherwin et al. 2017; Chao and Chiu 2016; Chao, Ricotta, and
Aldo 2019; Chao and Jost 2015)</span>. Not only do Hill diversities
unite variants of the most popular diversity metrics with a single
equation 1 <!--\@ref(eq:1) why doesn't this render correctly? -->, but
they always express diversity on an “effective numbers” scale, which
arguably facilitates comparison and interpretation <span class="citation">(Jost 2006; Roswell, Dushoff, and Winfree 2021)</span>.
However, despite the conceptual unity of Hill diversities, there is a
wide array of metrics that may be appropriate for a given case, opening
the questions of how to choose among them and to interpret differences
between them. Doing so demands intuition about the numerical,
biological, and statistical properties of these measures, which remain
under-explored. To facilitate such intuition, we developed the
<code>R</code> package <strong>MeanRarity</strong>, which enables
estimating and visualizing Hill diversity (aka “Hill numbers”) in terms
of the average species “rarity.” Rarity is defined as the reciprocal of
relative abundance.</p>
<p>The average species rarity may be simpler to interpret than a
transformed, generalized entropy (i.e., how Hill numbers are typically
derived <span class="citation">(Jost 2006)</span>). First, ecologists,
accustomed to thinking about rarity in the context of diversity, may
find it intuitive and useful to interpret Hill diversities as the
average species rarity on different scales <span class="citation">(Roswell, Dushoff, and Winfree 2021; Patil and Taillie
1982)</span>. Second, the rarity parameterization clarifies the role of
the scaling exponent, and this R package provides illustration tools to
visualize that scaling concretely. Furthermore, this framework may
provide an entry point for developing and testing diversity estimators
and their related interval estimates (e.g., confidence intervals); this
package contains tools to simulate species abundance distributions that
should streamline that process.</p>
<p>This R package provides functions for three purposes: (1) computing
Hill diversity as “Mean Rarity”, (2) visualizing and interpreting “Mean
Rarity”, and (3) simulating species abundance distributions with known
diversity. The package is available online on Github (see Data
accessibility). <!-- update if pushing
to CRAN, and/or include Zenodo link with DOI --> An interactive shiny
application for building “balance plots” is also available online (<a href="https://mean-rarity.shinyapps.io/rshiny_app1/" class="external-link uri">https://mean-rarity.shinyapps.io/rshiny_app1/</a>). In this
manuscript, we describe the core functions in the package, demonstrate
their application in a small study of bias and sampling variation in
Hill diversity estimates, and contrast <strong>MeanRarity</strong> with
several <code>R</code> packages that provide similar and/ or
complementary functionality.</p>
</div>
<div class="section level2">
<h2 id="package-description">PACKAGE DESCRIPTION<a class="anchor" aria-label="anchor" href="#package-description"></a>
</h2>
<div class="section level3">
<h3 id="computing-mean-rarity">Computing Mean Rarity<a class="anchor" aria-label="anchor" href="#computing-mean-rarity"></a>
</h3>
<p><code><a href="../reference/rarity.html">rarity()</a></code> computes Hill diversity of a sample,
parameterized in terms of the mean rarity.</p>
<p>We define Hill diversity <span class="math inline">\(D\)</span> as
the mean species rarity in the assemblage</p>
<p><span class="math display">\[D=\left(
\sum_{i=1}^{S}p_{i}(r_{i})^{\ell} \right)^{1/\ell} \tag{1}\]</span></p>
<p>where <span class="math inline">\(D\)</span> is diversity or mean
rarity, <span class="math inline">\(p_{i}\)</span> is the relative
abundance of species <span class="math inline">\(i\)</span>, <span class="math inline">\(r_{i}\)</span> is the rarity of species <span class="math inline">\(i\)</span> (defined as the reciprocal of <span class="math inline">\(p_{i}\)</span>), <span class="math inline">\(S\)</span> is the total species richness, and
<span class="math inline">\(\ell\)</span> is the scaling exponent that
determines the type of mean computed <span class="citation">(Roswell,
Dushoff, and Winfree 2021)</span>.</p>
<p>Hill diversity is more commonly written as</p>
<p><span class="math display">\[D=\left( \sum_{i=1}^{S}p_{i}^{q}
\right)^{1/1-q} \tag{2}\]</span> When <span class="math inline">\(\ell =
0\)</span> (<span class="math inline">\(q = 1\)</span>), these equations
are defined by their limit.</p>
<p>Equations 1 and 2 are equivalent when <span class="math inline">\(\ell = 1-q\)</span>. Re-parameterizing Hill
diversity in terms of species rarity can provide conceptual clarity.
Equation 1 is a weighted mean rarity, where the weights (relative
abundances, <span class="math inline">\(p_i\)</span>) are factored out
explicitly. Simplifying (as in Equation 2) hides the weighting by
relative abundance, and leads to the claim that the scaling exponent is
the “weight.” The concrete meaning of “weight” when applied to <span class="math inline">\(q\)</span> in Equation 2 may be difficult to
understand.</p>
<p>Because Equations 1 and 2 are algebraically equivalent,
<code>rarity(x, l)</code> is equivalent to
<code>vegan::renyi(x, scale = 1-l, hill = TRUE)</code>,
<code>entropart::Diversity(x, 1-l, Correction = "None"))</code>, or the
<code>qD</code> output from <code>iNEXT::estimateD(x)</code> where
<code>order = 1-l</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for a totally even distribution, Hill diversity is the same regardless of `l`</span></span>
<span></span>
<span><span class="va">even_comm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/rarity.html">rarity</a></span><span class="op">(</span><span class="va">even_comm</span>, <span class="fl">1</span><span class="op">)</span> <span class="co"># richness</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="fu"><a href="../reference/rarity.html">rarity</a></span><span class="op">(</span><span class="va">even_comm</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Hill-Simpson</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="../reference/rarity.html">rarity</a></span><span class="op">(</span><span class="va">even_comm</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="../reference/rarity.html">rarity</a></span><span class="op">(</span><span class="va">even_comm</span>, <span class="fl">0.34</span><span class="op">)</span>, <span class="fu"><a href="../reference/rarity.html">rarity</a></span><span class="op">(</span><span class="va">even_comm</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># for uneven communities, Hill diversity depends on `l`</span></span>
<span></span>
<span><span class="va">uneven_comm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">8</span>, <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">l_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0.34</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>l <span class="op">=</span> <span class="va">l_vals</span></span>
<span>           , Hill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">l_vals</span>, <span class="kw">function</span><span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">{</span></span>
<span>                    <span class="fu"><a href="../reference/rarity.html">rarity</a></span><span class="op">(</span><span class="va">uneven_comm</span>, <span class="va">l</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;       l     Hill</span></span>
<span><span class="co">#&gt; 1  1.00 6.000000</span></span>
<span><span class="co">#&gt; 2  0.00 4.057871</span></span>
<span><span class="co">#&gt; 3 -1.00 3.137255</span></span>
<span><span class="co">#&gt; 4  0.34 4.574320</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="interpreting-mean-rarity">Interpreting Mean Rarity<a class="anchor" aria-label="anchor" href="#interpreting-mean-rarity"></a>
</h3>
<p>One way of interpreting Hill diversities is that they express the
diversity of an assemblage in terms of an imaginary assemblage with that
same diversity, but in which all species are equally abundant <span class="citation">(Jost 2006)</span>. The parameter <span class="math inline">\(\ell\)</span>, along with the distribution of
abundances, determines where the equivalency lies (that is, what is the
“effective number of species” for that assemblage). The
<strong>MeanRarity</strong> package is designed to clarify what the
choice of <span class="math inline">\(\ell\)</span> reflects. Here, we
explore how the choice of <span class="math inline">\(\ell\)</span>
creates different equivalencies.</p>
<p>It may be perplexing to claim that a single assemblage, say, the
uneven assemblage <code>uneven_comm</code>, is simultaneously as diverse
as an assemblage of six (richness, <code>l = 1</code>), four
(Hill-Shannon diversity, <code>l = 0</code>), or three (Hill-Simpson
diversity, <code>l = -1</code>) species. Furthermore, when
<code>l = 1</code>, this assemblage is as diverse (or as species-rich)
as <em>any assemblage</em> with six species. At the same time, when
<code>l = -1</code>, it is about as diverse as an assemblage with twice
the number of species and tremendous unevenness, or half the number of
species and perfect evenness:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">uneven_12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">493</span>, <span class="fl">186</span>, <span class="fl">101</span>,  <span class="fl">63</span>, <span class="fl">41</span>, <span class="fl">28</span>, <span class="fl">19</span>, <span class="fl">13</span>, <span class="fl">9</span>, <span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">even_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/rarity.html">rarity</a></span><span class="op">(</span><span class="va">uneven_comm</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.14</span></span>
<span><span class="fu"><a href="../reference/rarity.html">rarity</a></span><span class="op">(</span><span class="va">uneven_12</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.14</span></span>
<span><span class="fu"><a href="../reference/rarity.html">rarity</a></span><span class="op">(</span><span class="va">even_3</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3</span></span></code></pre></div>
<p>Many authors have described <span class="math inline">\(\ell\)</span>
as a factor that weights species’ relative abundances - presumably
suggesting that downweighting rare species means a lower effective
diversity, while upweighting them means a higher effective diversity
<span class="citation">(e.g., Chao et al. 2014; Haegeman et al. 2013;
Tuomisto 2010; Cao and Hawkins 2019)</span>. Another interpretation
(developed in this package) is that <span class="math inline">\(\ell\)</span> <strong>rescales</strong> species
<em>rarities</em>. This interpretation lends itself to concrete
visualizations of Hill diversities as mean rarities, provided by
<code><a href="../reference/rarity_plot.html">rarity_plot()</a></code>.</p>
<p><code><a href="../reference/rarity_plot.html">rarity_plot()</a></code> makes “balance plots,” introduced below,
to visualize mean rarity. The idea behind a balance plot is that means
measure the [weighted] center, or a balance point, for a set of values.
If one imagines a plank with many weights on it, where the balance point
lies depends not only on the size of the weights weights, but also on
their relative locations… the farther towards the ends of the plank a
weight lies, the more leverage it has. When describing diversity, there
are simple rules for the species weights ([relative] abundances) and
where they lie (their <em>scaled</em> rarities). The rarity scaling is
given by the exponent <span class="math inline">\(\ell\)</span> from
equation 1, passed to the argument <code>l</code>. Here, we create three
balance plots for the three Pythagorean means, given when <span class="math inline">\(\ell \in \{1, 0,-1\}\)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">rich_bal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rarity_plot.html">rarity_plot</a></span><span class="op">(</span>ab <span class="op">=</span> <span class="va">uneven_comm</span>, l <span class="op">=</span> <span class="fl">1</span>, base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/seesaw_sugar.html">seesaw_sugar</a></span><span class="op">(</span><span class="st">"richness"</span>, l <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "diversity = 6"            "community size = 40"     </span></span>
<span><span class="co">#&gt; [3] "max observed rarity = 40" "min observed rarity = 2"</span></span>
<span>  </span>
<span></span>
<span><span class="va">shan_bal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/white_y.html">white_y</a></span><span class="op">(</span> <span class="co"># hide y axis</span></span>
<span>  <span class="fu"><a href="../reference/rarity_plot.html">rarity_plot</a></span><span class="op">(</span>ab <span class="op">=</span> <span class="va">uneven_comm</span></span>
<span>              , l <span class="op">=</span> <span class="fl">0</span></span>
<span>              , base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/seesaw_sugar.html">seesaw_sugar</a></span><span class="op">(</span><span class="st">"Hill-Shannon diversity"</span>, l <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "diversity = 4.05787109319726" "community size = 40"         </span></span>
<span><span class="co">#&gt; [3] "max observed rarity = 40"     "min observed rarity = 2"</span></span>
<span></span>
<span><span class="va">simp_bal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/white_y.html">white_y</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/rarity_plot.html">rarity_plot</a></span><span class="op">(</span>ab <span class="op">=</span> <span class="va">uneven_comm</span></span>
<span>              , l <span class="op">=</span> <span class="op">-</span><span class="fl">1</span></span>
<span>              , base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="../reference/seesaw_sugar.html">seesaw_sugar</a></span><span class="op">(</span><span class="st">"Hill-Simpson diversity"</span>, l <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "diversity = 3.13725490196078" "community size = 40"         </span></span>
<span><span class="co">#&gt; [3] "max observed rarity = 40"     "min observed rarity = 2"</span></span></code></pre></div>
<p>In a balance plot, the species integer abundances are plotted on the
y-axis, species rarities on the x-axis (values are back-transformed, but
scaling is dictated by <code>l</code>), the mean is shown with a
triangular “fulcrum,” and reference points are illustrated for the three
Pythagorean means (i.e., arithmetic, geometric, and harmonic, given when
<code>l = c(1, 0, -1)</code>, and equal to richness, Hill-Shannon
diversity, and Hill-Simpson diversity in purple, red, and green
respectively). <!-- too much of a mouthful?--> By default, each
individual is plotted as a “block”, and species with the same rarity are
stacked vertically.</p>
<p>As the value of the scaling exponent, <code>l</code>, increases,
large rarity values are compressed together, while small rarity values
are spread apart. A series of balance plots of the same abundances, but
with different <code>l</code> values, shows this spreading and
compression precisely. Meanwhile, the weights of each species are
determined wholly by their abundances (visualized as a stack of blocks).
Balance plots illustrate that even though the weights do not change with
the scaling exponent, the balance point (or fulcrum) shifts with
rescaling. In the first of the three plots below, the balance point sits
at the arithmetic mean (richness) at 6 (purple point). In the second,
the smaller rarities are shifted apart, while the larger rarity are
shifted together. The balance point shifts leftwards to the geometric
mean (Hill-Shannon diversity), at about 4.1 (red point). In the third,
the balance point shifts farther left still, to the harmonic mean
(Hill-Simpson diversity), at about 3.1 (green point).</p>
<!-- need to find a good way to control the balance plots for different devices/
rendering contexts -->
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rich_bal</span> <span class="op">+</span> </span>
<span><span class="va">shan_bal</span> <span class="op">+</span></span>
<span><span class="va">simp_bal</span> <span class="op">+</span></span>
<span>  <span class="fu">plot_layout</span><span class="op">(</span>widths <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"in"</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>                            , heights <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"in"</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Using_MeanRarity_files/figure-html/balance-plot-print-1.png" width="100%"></p>
<p>Rather than adjust abundances and scaling parameters in code, users
may experiment with balance plots using the <a href="https://mean-rarity.shinyapps.io/rshiny_app1/" class="external-link">R shiny web
application</a> that accompanies this package.</p>
<!-- do we want ot say anything about this here? -->
<p>Traditionally, Hill numbers in ecology have considered scaling
parameters of <span class="math inline">\(\ell \leq 1\)</span> i.e.,
<span class="math inline">\(q \geq 0\)</span>. However, scaling
parameter values outside this range may produce useful ecological
metrics as well <span class="citation">(Roswell, Harrison, and Genung
2023)</span>. Just as sample richness reflects density, total richness,
and the distribution of relative abundances, sample Hill diversities
with <span class="math inline">\(\ell &gt; 1\)</span> (<span class="math inline">\(q&lt;0\)</span>) reflect multiple community
aspects and may be preferable to sample richness as an ad-hoc index of
community size and complexity <span class="citation">(Roswell, Harrison,
and Genung 2023)</span>. One advantage of the <span class="math inline">\(\ell\)</span>-formulation is that it makes
transparent that although properties of the weighted mean shift around
<span class="math inline">\(\ell = 1\)</span> (increasing with observed
evenness for <span class="math inline">\(\ell &lt;1\)</span>, decreasing
with evenness for <span class="math inline">\(\ell &gt;1\)</span>),
species richness need not be the ultimate stopping point for emphasis on
rare species.</p>
</div>
<div class="section level3">
<h3 id="simulating-communities-with-known-diversity">Simulating communities with known diversity<a class="anchor" aria-label="anchor" href="#simulating-communities-with-known-diversity"></a>
</h3>
<p>Assessing the the performance of diversity estimators with real-world
data is difficult, because ecological communities are not typically
fully censused, and therefore the true diversity of sampled communities
is not known. <strong>MeanRarity</strong> includes a tool to simulate
species abundance distributions where diversity values are given as
parameters. This way, diversity (in this case, richness and Hill-Simpson
diversity) are known and fixed, rather than epiphenomena that fall out
of the simulations. In order to achieve this, we simulate species
abundance distributions with known, finite, true diversity, but infinite
abundance, from which finite samples may be taken. The diversity of a
given sample from such a species abundance distribution is therefore not
precisely pre-determined.</p>
<p>This approach differs from species abundance distribution simulations
implemented in other R packages. For example, <strong>mobsim</strong>
<span class="citation">(May et al. 2018)</span> and
<strong>sads</strong> <span class="citation">(Prado, Miranda, and Chalom
2022)</span> allow users to specify continuous parametric probability
distributions, but then take finite, discrete samples from those
distributions in the simulation (in <strong>mobsim</strong> these can
even be spatially explicit!). Users input canonical parameters of the
probability distributions and the number of individuals to sample. These
are powerful simulation tools, but one drawback common among them is
that the simulated diversity resulting from any given set of parameter
values is variable.</p>
<p><code><a href="../reference/fit_SAD.html">fit_SAD()</a></code>, by contrast, does not simulate individuals
explicitly. Instead, it always outputs precisely the same relative
abundances for a given set of parameters. By generating relative
abundances that do not depend on any kind of sampling scenario,
<code><a href="../reference/fit_SAD.html">fit_SAD()</a></code> makes it easy to consistently distinguish the
true, assemblage-level diversity from diversity estimates computed from
samples.</p>
<!-- cut next paragraph:
`fit_SAD()` simulates a species abundance distribution with known richness,
Hill-Simpson diversity, and a distributional assumption (lognormal or gamma). It
returns a shape parameter for the chosen probability distribution (because we're
focused on relative abundances, multiplicative rescaling is irrelevant), the
richness, Hill-Shannon, and Hill-Simpson diversity of the simulated species
abundance distribution, and relative abundances for each simulated species. It
provides a warning when the distribution includes species with very low relative
abundances, which implies a large total assemblage abundance.
 -->
<p>To visualize a realized or simulated species abundance distribution,
<strong>MeanRarity</strong> includes the convenience function
<code><a href="../reference/radplot.html">radplot()</a></code>, which plots species [relative] abundances
against species ranks.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set target richness and Hill-Simpson diversity levels</span></span>
<span><span class="va">rich</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">simpson</span> <span class="op">&lt;-</span> <span class="fl">12</span></span>
<span><span class="va">even_SAD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_SAD.html">fit_SAD</a></span><span class="op">(</span>rich <span class="op">=</span> <span class="va">rich</span>, simpson <span class="op">=</span> <span class="va">simpson</span>, distr <span class="op">=</span> <span class="st">"lnorm"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#output is a list with three elements</span></span>
<span><span class="va">even_SAD</span></span>
<span><span class="co">#&gt; $distribution_info</span></span>
<span><span class="co">#&gt;        distribution    fitted parameter </span></span>
<span><span class="co">#&gt;             "lnorm" "0.800796499428736" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $community_info</span></span>
<span><span class="co">#&gt;     richness Hill-Shannon Hill-Simpson </span></span>
<span><span class="co">#&gt;     20.00000     15.12064     12.00000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rel_abundances</span></span>
<span><span class="co">#&gt;  [1] 0.179084156 0.118048471 0.093645774 0.078786320 0.068255448 0.060160005</span></span>
<span><span class="co">#&gt;  [7] 0.053607807 0.048109941 0.043370042 0.039194597 0.035449466 0.032036573</span></span>
<span><span class="co">#&gt; [13] 0.028880258 0.025918380 0.023095535 0.020356288 0.017635391 0.014837055</span></span>
<span><span class="co">#&gt; [19] 0.011769975 0.007758517</span></span>
<span></span>
<span><span class="va">rich</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">simpson</span> <span class="op">&lt;-</span> <span class="fl">6</span></span>
<span><span class="va">uneven_SAD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_SAD.html">fit_SAD</a></span><span class="op">(</span>rich <span class="op">=</span> <span class="va">rich</span>, simpson <span class="op">=</span> <span class="va">simpson</span>, distr <span class="op">=</span> <span class="st">"lnorm"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ev</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/radplot.html">radplot</a></span><span class="op">(</span><span class="va">even_SAD</span><span class="op">$</span><span class="va">rel_abundances</span>, Whittaker <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># The default behavior is *not* to</span></span>
<span>  <span class="co"># log-transform [relative] abundances (i.e. it does not, by default, generate</span></span>
<span>  <span class="co"># a "Whitaker plot").</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"relative abundance"</span>, title <span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">y</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">y</span>, which will replace the existing scale.</span></span>
<span></span>
<span><span class="va">un</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/radplot.html">radplot</a></span><span class="op">(</span><span class="va">uneven_SAD</span><span class="op">$</span><span class="va">rel_abundances</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"relative abundance"</span>, title <span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Scale for <span style="color: #00BB00;">y</span> is already present.</span></span>
<span><span class="co">#&gt; Adding another scale for <span style="color: #00BB00;">y</span>, which will replace the existing scale.</span></span></code></pre></div>
<p>For any distribution of relative abundances, one can ask, “what is
the Hill diversity of this distribution?” Yet the answer, of course,
depends on the chosen value of the scaling parameter <span class="math inline">\(\ell\)</span>. For a comprehensive answer, one
might look across values of <span class="math inline">\(\ell\)</span>,
also known as a Hill “diversity profile” <span class="citation">(Chao et
al. 2014)</span>. <strong>MeanRarity</strong> provides a function to
generate a [sample] Hill diversity profile based on <span class="math inline">\(\ell\)</span> (rather than <span class="math inline">\(q\)</span>): <code><a href="../reference/divpro.html">divpro()</a></code>.
<code><a href="../reference/divpro.html">divpro()</a></code> does not estimate asymptotic diversity values (as
does, e.g., <code>SpadeR::Diversity()</code>), rather it simply computes
the Hill diversity profile for the [relative] abundances supplied by the
argument <code>ab</code>. As with all <strong>MeanRarity</strong>
functions, <code><a href="../reference/divpro.html">divpro()</a></code> can work with any real value for the
parameter <code>l</code> <span class="citation">(Roswell, Harrison, and
Genung 2023)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the even and uneven communities have same richness but different Hill </span></span>
<span><span class="co"># diversity when `ell != 1`</span></span>
<span></span>
<span><span class="va">proPlot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">ab</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="../reference/divpro.html">divpro</a></span><span class="op">(</span><span class="va">ab</span><span class="op">)</span></span>
<span>                , <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">ell</span>, <span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">22</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"scaling exponent \'l\'"</span>, y <span class="op">=</span> <span class="st">"Hill diversity"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">ev_prof</span> <span class="op">&lt;-</span> <span class="fu">proPlot</span><span class="op">(</span><span class="va">even_SAD</span><span class="op">$</span><span class="va">rel_abundances</span><span class="op">)</span></span>
<span></span>
<span><span class="va">un_prof</span> <span class="op">&lt;-</span> <span class="fu">proPlot</span><span class="op">(</span><span class="va">uneven_SAD</span><span class="op">$</span><span class="va">rel_abundances</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ev</span><span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span> <span class="va">ev_prof</span><span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">/</span> <span class="op">(</span><span class="va">un</span> <span class="op">+</span> <span class="va">un_prof</span><span class="op">)</span></span></code></pre></div>
<p><img src="Using_MeanRarity_files/figure-html/radplots-and-profiles-1.png" width="40%"></p>
<p><code><a href="../reference/fit_SAD.html">fit_SAD()</a></code> generates an ideal species abundance
distribution, with relative abundances for an assemblage with infinite
abundance. In the <strong>MeanRarity</strong> package, to take a finite
sample from an ideal species abundance distribution, we use
<code><a href="../reference/sample_infinite.html">sample_infinite()</a></code> (so named because it samples an infinite
SAD; <code><a href="../reference/sample_finite.html">sample_finite()</a></code> is for sub-sampling from a realized
assemblage/finite sample).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># diversity of a small sample unlikely to match the simulated diversity values</span></span>
<span></span>
<span><span class="co"># first, sample from our simulated SADs</span></span>
<span></span>
<span><span class="va">even_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_infinite.html">sample_infinite</a></span><span class="op">(</span><span class="va">even_SAD</span><span class="op">$</span><span class="va">rel_abundances</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">uneven_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_infinite.html">sample_infinite</a></span><span class="op">(</span><span class="va">uneven_SAD</span><span class="op">$</span><span class="va">rel_abundances</span>, <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co"># `sample_infinite()` returns a numeric vector of sample species abundances</span></span>
<span><span class="va">even_sample</span></span>
<span><span class="co">#&gt;  [1] 11  4  4  5  2  3  1  2  1  1  5  4  2  2  0  0  0  2  1  0</span></span>
<span><span class="va">uneven_sample</span></span>
<span><span class="co">#&gt;  [1] 12  8 10  2  0  3  3  1  3  2  1  1  0  1  2  0  0  1  0  0</span></span>
<span></span>
<span><span class="co"># we can compare evenness (given a scaling parameter `l`)</span></span>
<span><span class="co"># the evenness is the normalized ratio of the specified Hill diversity to </span></span>
<span><span class="co"># richness</span></span>
<span><span class="fu"><a href="../reference/e3Fun.html">e3Fun</a></span><span class="op">(</span><span class="va">even_sample</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.594709</span></span>
<span><span class="fu"><a href="../reference/e3Fun.html">e3Fun</a></span><span class="op">(</span><span class="va">uneven_sample</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4694056</span></span>
<span></span>
<span><span class="co"># compare diversity from sample vs. ideal SAD:</span></span>
<span><span class="co"># likely pretty far off for a small sample!</span></span>
<span></span>
<span><span class="co"># with an even SAD, all diversities lower</span></span>
<span><span class="va">even_SAD</span><span class="op">$</span><span class="va">community_info</span></span>
<span><span class="co">#&gt;     richness Hill-Shannon Hill-Simpson </span></span>
<span><span class="co">#&gt;     20.00000     15.12064     12.00000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/rarity.html">rarity</a></span><span class="op">(</span><span class="va">even_sample</span>, <span class="va">l</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"richness"</span>, <span class="st">"Hill-Shannon"</span>, <span class="st">"Hill-Simpson"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      richness Hill-Shannon Hill-Simpson</span></span>
<span><span class="co">#&gt; [1,] 16       12.49516     9.920635</span></span>
<span></span>
<span><span class="co"># with an uneven SAD, sample Hill-Simpson can be higher than true Hill-Simpson</span></span>
<span><span class="co"># richness is always lower</span></span>
<span><span class="va">uneven_SAD</span><span class="op">$</span><span class="va">community_info</span></span>
<span><span class="co">#&gt;     richness Hill-Shannon Hill-Simpson </span></span>
<span><span class="co">#&gt;    20.000000     9.370171     6.000000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/rarity.html">rarity</a></span><span class="op">(</span><span class="va">uneven_sample</span>, <span class="va">l</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"richness"</span>, <span class="st">"Hill-Shannon"</span>, <span class="st">"Hill-Simpson"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      richness Hill-Shannon Hill-Simpson</span></span>
<span><span class="co">#&gt; [1,] 14       9.407337     7.102273</span></span>
<span></span>
<span></span>
<span><span class="va">big_even_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_infinite.html">sample_infinite</a></span><span class="op">(</span><span class="va">even_SAD</span><span class="op">$</span><span class="va">rel_abundances</span>, <span class="fl">1e7</span><span class="op">)</span></span>
<span><span class="va">big_uneven_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_infinite.html">sample_infinite</a></span><span class="op">(</span><span class="va">uneven_SAD</span><span class="op">$</span><span class="va">rel_abundances</span>, <span class="fl">1e7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># with a big enough sample, simulated diversities nearly recovered</span></span>
<span><span class="va">even_SAD</span><span class="op">$</span><span class="va">community_info</span></span>
<span><span class="co">#&gt;     richness Hill-Shannon Hill-Simpson </span></span>
<span><span class="co">#&gt;     20.00000     15.12064     12.00000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/rarity.html">rarity</a></span><span class="op">(</span><span class="va">big_even_sample</span>, <span class="va">l</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"richness"</span>, <span class="st">"Hill-Shannon"</span>, <span class="st">"Hill-Simpson"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      richness Hill-Shannon Hill-Simpson</span></span>
<span><span class="co">#&gt; [1,] 20       15.11834     11.99503</span></span>
<span></span>
<span><span class="va">uneven_SAD</span><span class="op">$</span><span class="va">community_info</span></span>
<span><span class="co">#&gt;     richness Hill-Shannon Hill-Simpson </span></span>
<span><span class="co">#&gt;    20.000000     9.370171     6.000000</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">l</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/rarity.html">rarity</a></span><span class="op">(</span><span class="va">big_uneven_sample</span>, <span class="va">l</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">`colnames&lt;-`</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"richness"</span>, <span class="st">"Hill-Shannon"</span>, <span class="st">"Hill-Simpson"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      richness Hill-Shannon Hill-Simpson</span></span>
<span><span class="co">#&gt; [1,] 20       9.365799     5.996038</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="example-applications">EXAMPLE APPLICATIONS<a class="anchor" aria-label="anchor" href="#example-applications"></a>
</h2>
<div class="section level3">
<h3 id="drivers-of-sampling-uncertainty-in-hill-diversity-estimates">Drivers of sampling uncertainty in Hill diversity estimates<a class="anchor" aria-label="anchor" href="#drivers-of-sampling-uncertainty-in-hill-diversity-estimates"></a>
</h3>
<p>Accurate estimates of Hill diversity based on sample data are
notoriously challenging <span class="citation">(Roswell, Dushoff, and
Winfree 2021)</span>. Although many estimators have been used, the three
most common approaches are to a) calculate the diversity of samples
directly, treating this as a sample-size-dependent diversity measure
(i.e. “sample diversity”) (CITE SMITH AND GRASSLE), b) calculate the
diversity of the sample directly, but treat this as an estimate of the
diversity of the entire assemblage (sometimes called the “plug-in
estimator”) (CITE SOMEBODY), or c) use non-parametric estimators of the
diversity of the entire assemblage, or an “asymptotic estimator” <span class="citation">(Chao and Jost 2015)</span>. All three approaches may
have merit for comparing communities and ecosystems <span class="citation">(Gooriah et al. 2021)</span> <!-- may want a stronger
reference here-->.
<!-- I think we might need to say a bit more about sample
diversity as its own thing (Peet 1974, Smith and Grassle, Hurlbert 1971) vs. as
an estimator of their asymptotic values. I think McGill 2011 from MacGurran and
McGill is really bad about this, as an e.g., but we probably won't say that
here. --> While the degree to which sample diversity and asymptotic
estimates each differ from the true diversity of the full assemblage
(bias) has received substantial study, the sampling variation in each
type of Hill diversity estimate is less understood, as are potential
differences in this variation between sample diversities and their
asymptotic estimators. <strong>MeanRarity</strong> provides a toolkit to
explore accuracy and sampling uncertainty for Hill diversity estimates.
Because this package simulates species abundance distributions with
known diversity, it allows examination of the drivers of sampling
variation in Hill diversity estimates.</p>
<p>It is well known that the diversity of a sample tends to be lower
than the diversity of the assemblage from which the sample was drawn
<span class="citation">(Chao and Jost 2015)</span>. This “bias” (i.e.,
when sample diversity is used as a “plug-in” estimator for the true,
assemblage-level diversity, rather than as its own index <span class="citation">Smith and Grassle (1977)</span>) is most acute for
species richness, but can be substantial for all Hill diversities. The
degree of mismatch between the sample and true diversity is difficult to
know with real assemblages, but this can be addressed directly through
simulation. At the same time, current asymptotic Hill diversity
estimators <span class="citation">(Chao and Jost 2015)</span> typically
exhibit little bias when sample sizes are reasonably large (hundreds of
individuals) and <span class="math inline">\(\ell \lesssim
0.25\)</span>. Less well-understood is how different features of the
species abundance distribution (e.g. evenness, or just how rare the
rarest species are) drive the degree of difference between either
sampled diversity or asymptotic estimators, and the true diversity of
the sampled species abundance distribution.</p>
<p>Similarly, the sampling variation in Hill diversity estimates (both
sample diversity/the naïve estimator, and asymptotic estimators) is
poorly understood. Intuitively, sampling variability in Hill diversity
estimates must depend jointly on sample size, the species abundance
distribution, and the scaling exponent for Hill diversity. However,
users of Hill diversity currently lack guidance on the relationship
between their metric choice and the sampling variability they might
expect. Variability, along with bias, is an important consideration when
selecting a diversity metric. Especially when the number of replicates
is modest, as is often the case in ecological studies, inaccuracy due to
random sampling variability could lead to equally misleading results as
could bias <span class="citation">(Gelman and Carlin 2014)</span>.</p>
<p>To explore how the shape of the species abundance distribution and
sample size drive the sampling expectations for sample and asymptotic
Hill diversity estimates, we can first simulate species abundance
distributions using the function <code>MeanRarity::fitSAD()</code>.
Here, we generated six distributions: for three levels of evenness, we
simulated both a lognormally- and gamma-distributed assemblage of 100
species. To parameterize evenness, we used (Hill-Simpson diversity
-1)/(richness-1), which is equal to 1 with a perfectly even
species-abundance distribution, and 0 when Hill-Simpson diversity
reaches its minimum, 1, for any richness value <span class="citation">(Kvalseth 1991; Chao, Ricotta, and Aldo 2019)</span>.
Thus, in each simulated assemblage, we know richness to be 100,
Hill-Simpson takes one of three values given by the evenness parameter,
and other Hill diversities depend on the distributional assumption
(gamma or lognormal).</p>
<p><code>MeanRarity::fitSAD()</code> returns species relative abundances
(a SAD), and we generate finite, discrete abundance samples with the
function <code><a href="../reference/sample_infinite.html">MeanRarity::sample_infinite()</a></code>. Here, we generated
1000 samples from each simulated SAD of 31, 100, 316, and 1000
individuals. Then, for each sample, we computed Hill diversity profiles
for both the sample and estimated asymptotic Hill diversities. For each
combination of SAD, sample size, and estimate type (i.e., sample,
“naïve,” or asymptotic) we plotted measures of total error, variability,
and bias along the Hill diversity profile from Hill-Simpson diversity to
richness. For total error, we plotted the root mean squared log ratio
between each estimate and the target value (i.e mean sample diversity or
true diversity), hereafter “rmsle.” For bias, we plotted the log ratio
between the Hill diversity estimate and its target, and for variability
we plotted the standard deviation of the log Hill diversity (a unitless
measure of variability). Mean squared log error is the sum of the
squared bias and the variance in the log diversity estimates. We asked,
on a relative scale, how choice of scaling exponent for Hill diversity
affects total error, bias, and sampling variability, and explored the
interactions with evenness, distributional assumption, and sample
size.</p>
<p>The diversity of a sample of fixed size was a stable, accurate
measure of rarefied diversity across all the SADs we tested. The total
error, greatest for Hill-Simpson diversity, when samples were smaller,
and for less even SADs, shrank quickly as sample sizes increased, and
was driven entirely by sampling variability, as the sample diversity is
a natural unbiased estimator for the expected diversity of a random
sample of a given size. Most surprising for us was that the variability
for sample diversity was typically highest for Hill-Simpson diversity
than for other Hill diversities, until sample sizes got quite large.
Although the shape of the SAD (e.g. “lnorm” vs. “gamma”) affected the
variability in sample Hill diversity, how it does so appeared to depend
on both the Hill scaling exponent and sample size.</p>
<p>The diversity of a sample of fixed size was a stable, but inaccurate
measure of true diversity, as has been extensively reported elsewhere
(REFS). Although the variability of the naïve estimator is identical to
the variability in sample diversity, the bias, i.e. the ratio between
sample and true diversity, depends jointly on the choice of Hill scaling
exponent, the SAD, and sampling completeness <span class="citation">(Roswell, Dushoff, and Winfree 2021)</span>.</p>
<p>We found a strong negative bias for species richness for the
asymptotic estimator, as well as for the naïve estimator, but when
sample diversity is not treated as an estimator for the full assemblage
diversity, it has no “bias” (CITE Smith and Grassle, Hurlbert, Dauby
&amp; Hardy). Evenness and distributional assumption of the SAD affected
the bias for both the naïve and asymptotic Hill diversity estimates.
More even communities tended to exhibit lower bias for richness but
higher bias for Hill-Simpson diversity, although this pattern depended
to some degree on both distributional assumption and sampling intensity.
For the asymptotic Hill diversity estimates, bias at very low sample
sizes was less than sample diversity but could still be extreme.
However, this bias evaporated quickly for both sample and asymptotic
Hill diversity estimates when the scaling exponent <span class="math inline">\(\ell &lt;&lt; 1\)</span>.</p>
<!-- check theme options like panel.spacing and legend.key.width -->
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lnorm"</span>, <span class="st">"gamma"</span>, <span class="st">"invgamma"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">dist</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="va">myp</span> <span class="op">&lt;-</span> <span class="va">err_plot_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>plugin_sdlog <span class="op">=</span> <span class="va">sample_sdlog</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">16</span><span class="op">)</span></span>
<span>                 , names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"est"</span>, <span class="st">"err_type"</span><span class="op">)</span></span>
<span>                 , names_pattern <span class="op">=</span> <span class="st">"(.*)_(.*)"</span></span>
<span>                 , values_to <span class="op">=</span> <span class="st">"this_error"</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>err_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">err_type</span></span>
<span>                                    , levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rmsle"</span>, <span class="st">"sdlog"</span>, <span class="st">"bias"</span><span class="op">)</span></span>
<span>                                    , labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Average proportional error"</span></span>
<span>                     , <span class="st">"Proportional \nVariability"</span></span>
<span>                     , <span class="st">"Proportional Bias"</span><span class="op">)</span></span>
<span>                                    <span class="op">)</span></span>
<span>                  , est <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">est</span> <span class="op">==</span> <span class="st">"estimator"</span>, <span class="st">"asymptotic"</span></span>
<span>                                , <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">est</span> <span class="op">==</span> <span class="st">"naive"</span></span>
<span>                                                 , <span class="st">"plug-in"</span></span>
<span>                                                 , <span class="st">"sample"</span><span class="op">)</span><span class="op">)</span></span>
<span>                  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="co"># dplyr::mutate(this_error = dplyr::if_else(abs(this_error) &gt; 2</span></span>
<span>    <span class="co">#                                           , sign(this_error) * Inf</span></span>
<span>    <span class="co">#                                           , this_error) # workaround</span></span>
<span>    <span class="co">#               # to get big values on plot given geom_line, I think</span></span>
<span>    <span class="co">#               , this_error = round(this_error, 11)) %&gt;%</span></span>
<span>    <span class="co">#               # and here, to get 0-values to look like 0. </span></span>
<span>     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">distribution</span> <span class="op">==</span> <span class="va">dist</span> <span class="co"># </span></span>
<span>                   <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ell</span></span>
<span>                                 , color <span class="op">=</span> <span class="va">evenness</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">this_error</span> <span class="co">#exp(this_error)</span></span>
<span>      , linetype <span class="op">=</span> <span class="va">est</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>strip.background <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>                   , strip.placement.y <span class="op">=</span> <span class="st">"outside"</span></span>
<span>                   , panel.spacing.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1.3</span>, <span class="st">"lines"</span><span class="op">)</span></span>
<span>                   , panel.spacing.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1.3</span>, <span class="st">"lines"</span><span class="op">)</span></span>
<span>                   , legend.key.width <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"lines"</span><span class="op">)</span></span>
<span>                   <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span>                                <span class="op">)</span> <span class="op">+</span></span>
<span>    </span>
<span>    <span class="co"># ratioScales::scale_y_ratio(slashStar = FALSE, anchor = 1) +</span></span>
<span>     <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>       labels <span class="op">=</span> <span class="fu">ratioScales</span><span class="fu">::</span><span class="fu"><a href="https://mikeroswell.github.io/ratioScales/reference/label_divMult.html" class="external-link">label_divMult</a></span><span class="op">(</span>logscale <span class="op">=</span> <span class="cn">TRUE</span>, slashStar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span>       , breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">1.5</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">1.2</span>, <span class="fl">1</span>, <span class="fl">1.2</span>, <span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span>       <span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">4</span></span>
<span>                                , palette <span class="op">=</span> <span class="st">"SunsetDark"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span>
<span>                                <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"solid"</span>, <span class="st">"dashed"</span>, <span class="st">"dotted"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">err_type</span><span class="op">~</span><span class="va">sample_size</span></span>
<span>                        , labeller <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link">labeller</a></span><span class="op">(</span></span>
<span>                          sample_size <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="va"><a href="https://ggplot2.tidyverse.org/reference/labellers.html" class="external-link">label_both</a></span></span>
<span>                          , err_type <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="va"><a href="https://ggplot2.tidyverse.org/reference/labellers.html" class="external-link">label_value</a></span></span>
<span>                          <span class="op">)</span></span>
<span>                        , scales <span class="op">=</span> <span class="st">"free_y"</span></span>
<span>                        <span class="co"># , space = "free_y"</span></span>
<span>                        , switch <span class="op">=</span> <span class="st">"y"</span></span>
<span>                        <span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"scaling exponent \U2113"</span></span>
<span>                  , y <span class="op">=</span> <span class="st">""</span></span>
<span>                  , linetype <span class="op">=</span> <span class="st">"estimator"</span></span>
<span>                   <span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">myp</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Warning: Removed 180 rows containing missing values (`geom_line()`).</span></span></code></pre></div>
<p><img src="Using_MeanRarity_files/figure-html/bias-figure-1.png" width="1050"></p>
<pre><code><span><span class="co">#&gt; Warning: Removed 180 rows containing missing values (`geom_line()`).</span></span></code></pre>
<p><img src="Using_MeanRarity_files/figure-html/bias-figure-2.png" width="1050"></p>
<pre><code><span><span class="co">#&gt; Warning: Removed 180 rows containing missing values (`geom_line()`).</span></span></code></pre>
<p><img src="Using_MeanRarity_files/figure-html/bias-figure-3.png" width="1050"></p>
<pre><code><span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; Warning: Removed 180 rows containing missing values (`geom_line()`).</span></span></code></pre>
<p><img src="Using_MeanRarity_files/figure-html/bias-figure-4.png" width="1050"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; Warning: Removed 180 rows containing missing values (`geom_line()`).</span></span></code></pre>
<p><img src="Using_MeanRarity_files/figure-html/bias-figure-5.png" width="1050"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; Warning: Removed 180 rows containing missing values (`geom_line()`).</span></span></code></pre>
<p><img src="Using_MeanRarity_files/figure-html/bias-figure-6.png" width="1050"></p>
<!-- fig caption draft -->
<p>Figure X: Hill-Simpson diversity estimates have high variability
under random sampling.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># # Was curious about the parameter space in which the plug-in estimator </span></span>
<span><span class="co"># # actually outperforms the Chao and Jost 2015 estimator</span></span>
<span></span>
<span><span class="co"># occam &lt;- err_plot_data %&gt;%</span></span>
<span><span class="co">#   dplyr::group_by(evenness, distribution, ell, sample_size) %&gt;%</span></span>
<span><span class="co">#   dplyr::summarize(total = estimator_rmsle &gt; naive_rmsle</span></span>
<span><span class="co">#             , bias = abs(estimator_bias) &gt; abs(naive_bias)</span></span>
<span><span class="co">#             , variability = estimator_sdlog &gt; sample_sdlog)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># occam %&gt;%</span></span>
<span><span class="co">#   dplyr::filter(total %in% c(TRUE, FALSE)) %&gt;%</span></span>
<span><span class="co">#   ggplot2::ggplot(ggplot2::aes(total, ell</span></span>
<span><span class="co">#     , color = as.factor(sample_size), shape = distribution ))+</span></span>
<span><span class="co">#   ggplot2::geom_jitter(height = 0, width = 0.4)+</span></span>
<span><span class="co">#   ggplot2::scale_color_manual(values = hcl.colors(4, "Plasma")) +</span></span>
<span><span class="co">#   ggplot2::facet_wrap(~evenness)+</span></span>
<span><span class="co">#   ggplot2::labs(x = "plug-in estimator beats Chao (rmsle)")+</span></span>
<span><span class="co">#   ggplot2::ylim(c(-1, 1))</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># occam %&gt;%</span></span>
<span><span class="co">#   dplyr::filter(bias %in% c(TRUE, FALSE)) %&gt;%</span></span>
<span><span class="co">#   ggplot2::ggplot(ggplot2::aes(bias, ell, color = as.factor(sample_size), shape = distribution ))+</span></span>
<span><span class="co">#   ggplot2::geom_jitter(height = 0, width = 0.4)+</span></span>
<span><span class="co">#   ggplot2::scale_color_manual(values = hcl.colors(4, "Plasma")) +</span></span>
<span><span class="co">#   ggplot2::facet_wrap(~evenness)+</span></span>
<span><span class="co">#   ggplot2::labs(x = "plug-in estimator beats Chao (log accuracy ratio)")+</span></span>
<span><span class="co">#   ggplot2::ylim(c(-1, 1))</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># occam %&gt;%</span></span>
<span><span class="co">#   dplyr::filter(variability %in% c(TRUE, FALSE)) %&gt;%</span></span>
<span><span class="co">#   ggplot2::ggplot(ggplot2::aes(variability, ell</span></span>
<span><span class="co">#     , color = as.factor(sample_size), shape = distribution ))+</span></span>
<span><span class="co">#   ggplot2::geom_jitter(height = 0, width = 0.4)+</span></span>
<span><span class="co">#   ggplot2::scale_color_manual(values = hcl.colors(4, "Plasma")) +</span></span>
<span><span class="co">#   ggplot2::facet_wrap(~evenness)+</span></span>
<span><span class="co">#   ggplot2::labs(x = "plug-in estimator beats Chao (sdlog)")+</span></span>
<span><span class="co">#   ggplot2::ylim(c(-1, 1))</span></span></code></pre></div>
<p>Much less explored is the variability of both sample diversity, and
of asymptotic diversity estimates, under random sampling expectations.
Here, our results were striking, and challenged the orthodoxy that
Hill-Simpson diversity is the low-uncertainty option for comparing
assemblages <span class="citation">(Lande, Devries, and Walla
2000)</span> <!-- this
is probably the strongest citation I can put my hands on but insufficient to
claim an "Orthodoxy" from this. --> . The sample Hill-Simpson diversity,
which has been promoted as a diversity metric that is robust to
variation in sampling intensity <span class="citation">(Chase and Knight
2013)</span>, exhibited high sampling uncertainty for most SADs and
sampling intensities… greater variability than for any other sample Hill
diversity. Across Hill diversities, the asymptotic estimator was
typically more variable than the sample diversity was. This was
especially the case for richness. While the sampling variability in the
asymptotic Hill-Simpson diversity was still higher than for the
asymptotic Hill-Shannon diversity, as we saw for the sample diversity,
as the scaling exponent <span class="math inline">\(\ell\)</span>
approached 1 (i.e. increased emphasis on rare species, closer to
richness), the variability was high and declined slowly with additional
sampling. Depending on the evenness and distributional assumption of the
SAD, the asymptotic richness estimate could be more, or less, variable
than the asymptotic Hill-Simpson diversity estimate.</p>
</div>
</div>
<div class="section level2">
<h2 id="alternative-software">ALTERNATIVE SOFTWARE<a class="anchor" aria-label="anchor" href="#alternative-software"></a>
</h2>
<p>Functions to generate similar diversity estimates and assemblage
simulations are available in several R packages.</p>
<!-- this is currently placeholders, but need to fill this out. Will require
some serious focused time and maybe some blog posts -->
<ol style="list-style-type: decimal">
<li><p><strong>iNEXT</strong> The R package <strong>iNEXT</strong>
provides tools for rarefaction and extrapolation of sample Hill
diversity estimates, and point estimates for asymptotic estimators for
richness, Hill-Shannon, and Hill-Simpson. It computes sample Hill
diversity for <span class="math inline">\(\ell\leq 1 = q \geq
0\)</span>. By contrast, the function <code><a href="../reference/rarity.html">MeanRarity::rarity()</a></code>
also computes mean rarity when <span class="math inline">\(\ell&gt;1\)</span> <span class="citation">(Roswell, Harrison, and Genung 2023)</span>. Although
estimates from <strong>iNEXT</strong> and <strong>MeanRarity</strong>
should tend to be congruent for <span class="math inline">\(\ell =
1-q\)</span>, MeanRarity provides users with the option to use <span class="math inline">\(\ell\)</span> throughout, emphasizing the
MeanRarity framework developed in Roswell et al. 2021 <span class="citation">(Roswell, Dushoff, and Winfree 2021)</span>.
<strong>iNEXT</strong> functions are highly integrated, generating
multiple outputs and computing bootstrapped variance estimates by
default, whereas in <strong>MeanRarity</strong> most exported functions
are comparatively simple. <strong>MeanRarity</strong> enables
parameterizing Hill diversity with <code>q</code> or <code>l</code>, and
provides tools for simulating species abundance distributions and
visualizing mean rarity, which <strong>iNEXT</strong> does not, this may
make <strong>MeanRarity</strong> best suited to students and those
studying biodiversity estimation. <strong>iNEXT</strong> is well-suited
to plotting empirical diversity data from a small to modest number of
assemblages.</p></li>
<li><p><strong>SpadeR</strong> The R package <strong>SpadeR</strong>
provides similar estimates for Hill diversity as <strong>iNEXT</strong>,
also parameterized by <span class="math inline">\(q\)</span> rather than
<span class="math inline">\(\ell\)</span> (<strong>MeanRarity</strong>
allows either parameterization, defaulting to <span class="math inline">\(\ell\)</span>). <code>SpadeR::Diversity</code>,
like <code><a href="../reference/divpro.html">MeanRarity::divpro</a></code>, generates a Hill diversity
“profile”. Internal functions from <code>SpadeR</code> are used as
source code in <strong>MeanRarity</strong> (e.g. a simplified version
of<code>SpadeR:::Chao_Hill_abu()</code> is an exported function in
<strong>MeanRarity</strong>). While <code>SpadeR</code> provides a suite
of tools for estimating alpha- and beta-diversity,
<strong>MeanRarity</strong> provides additional tools for simulation,
visualization, and alternative parameterization with <span class="math inline">\(\ell\)</span>.</p></li>
<li><p><strong>vegan</strong></p></li>
</ol>
<p>The <code>R</code> package <strong>vegan</strong> contains a
multitude of tools for comparing community data in <code>R</code>. Like
<strong>MeanRarity</strong>, <strong>vegan</strong> contains tools to
estimate Hill diversity (<code>vegan::renyi(..., hill = TRUE)</code>),
rarefy datasets (<code><a href="https://rdrr.io/pkg/vegan/man/specaccum.html" class="external-link">vegan::specaccum()</a></code>), and fit parametric
distributions to abundance vectors (<code><a href="https://rdrr.io/pkg/vegan/man/fisherfit.html" class="external-link">vegan::fisherfit()</a></code>).
While <strong>vegan</strong> is highly versatile, historical artifacts
may lead to confusion about Hill diversity. For example,
<code>vegan::diversity(x, "invsimpson") == 1/(1-vegan::diversity(x, "simpson"))</code>,
although users might reasonably assume that
<code>vegan::diversity(x, "invsimpson")   == 1/vegan::diversity(x, "simpson")</code>.
<strong>MeanRarity</strong> focuses on the interpretation of Hill
diversities as average of species rarities across scales, to dispel
confusion.</p>
<ol style="list-style-type: decimal">
<li><p><strong>sads</strong> The R package <strong>sads</strong>
provides functions to fit parametric distributions to abundance vectors
using maximum-likelihood. The function `<code>sads::rsad()</code>, like
<code><a href="../reference/fit_SAD.html">MeanRarity::fit_SAD()</a></code>, generates abundance vectors based on
parametric distributions for true species abundance distributions. While
<code>sads::rsad()</code> returns integer-abundance for a simulated
<em>sample</em> from a parametric species abundance distribution,
<code><a href="../reference/fit_SAD.html">MeanRarity::fit_SAD()</a></code> returns relative abundances for the
underlying distribution itself. <code><a href="../reference/fit_SAD.html">MeanRarity::fit_SAD</a></code> expands
on the functionality of <code>sads::rsad</code> by enabling users to
parameterize the underlying species abundance distributions by both true
richness and true Hill-Simpson diversity, rather than richness
alone.</p></li>
<li><p><strong>mobsim</strong> The R package <strong>mobsim</strong>
expands on the simulations provided by <strong>sads</strong> to generate
spatially-explicit simulations. Unlike <strong>MeanRarity</strong>,
<strong>mobsim</strong> provides tools to simulate and estimate
diversity-area relationships. However, in <strong>mobsim</strong>, the
diversity of an assemblage is an outcome of a simulation, rather than an
input, whereas <code><a href="../reference/fit_SAD.html">MeanRarity::fit_SAD()</a></code> allows users to input
diversity directly, and sample from a distribution with known diversity
with <code><a href="../reference/sample_infinite.html">MeanRarity::sample_infinite()</a></code>. These functionalities
enable complementary approaches to studying the behavior of diversity
estimates under different sampling scenarios.</p></li>
<li><p><strong>entropart</strong> The <code>Diversity()</code> function
in <strong>entropart</strong> computes several estimators of Hill
diversities (and several relevant monotonic transformations) for any
real value of <code>q = 1-l</code>, and with the option
<code>Correction = "None"</code> is congruent with
<code><a href="../reference/rarity.html">MeanRarity::rarity()</a></code>. <strong>entropart</strong> uses
entropy, rather than mean rarity, as the conceptual starting point, and
includes several entropy-focused estimation tools beyond those included
in <strong>MeanRarity</strong>, <strong>spadeR</strong>,
<strong>iNEXT</strong>, or <strong>vegan</strong>.</p></li>
<li><p><strong>EntropyEstimation</strong> Zhang and Grabchak 2014
provided novel entropy estimators, and this package implements their
estimators across a variety of entropy-based diversity indices. The
function <code><a href="https://rdrr.io/pkg/EntropyEstimation/man/Hill.z.html" class="external-link">EntropyEstimation::Hill.z()</a></code> computes the
exponentiated estimated Renyi entropy (a.k.a. Hill diversity) for order
<span class="math inline">\(r = 1-l\)</span>. For comparison with other
Hill diversity estimators, users are referred to
<strong>entropart</strong>.</p></li>
<li><p><strong>Richness</strong> This package is available from Github
<a href="https://github.com/EWTekwa/Richness" class="external-link uri">https://github.com/EWTekwa/Richness</a> and provides the
function <code>RichnessEsts()</code>, which generates point estimates
for asymptotic species richness using a variety of methods, including
the novel one introduces in Tekwa et al. 2023 PTRSB. This new estimator
is not generalized to all Hill diversities, which are the focus of
<strong>MeanRarity</strong>.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="conclusions">CONCLUSIONS<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>The <code>R</code> package <strong>MeanRarity</strong> enables a
coherent study of Hill diversity metrics through the framework of
average species rarity. As Hill diversity metrics gain popularity,
<strong>MeanRarity</strong> provides tools to estimate and visualize
them, and enables continuing research into the properties of these
metrics. <strong>MeanRarity</strong> also facilitates simulating
assemblages with known diversity, which is not easily done with other
popular software packages for biodiversity science. To illustrate the
use of the package in a research program, we tested how different
distributions of relative abundance in assemblages drives sampling
uncertainty in Hill diversity estimators. We found that Hill-Simpson
diversity and its asymptotic estimator, which have been promoted as
stable, robust measures of biodiversity due to relative emphasis on
common, rather than rare species, exhibit high variability, especially
in the presence of low evenness and very rare species.</p>
<div class="section level3">
<h3 id="acknowledgements">ACKNOWLEDGEMENTS<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h3>
<p>We thank Luke Harmon for early feedback on the R package, Stephen
Beckett for helpful feedback on the manuscript draft, and…</p>
</div>
<div class="section level3">
<h3 id="author-contributions">AUTHOR CONTRIBUTIONS<a class="anchor" aria-label="anchor" href="#author-contributions"></a>
</h3>
<p>M.R. and J.D. conceived the package concept and structure and
generated source code for package functions. M.R. implemented the first
package version and the shiny online application. M.R. wrote the
manuscript with help from J.D.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-accessibility">DATA ACCESSIBILITY<a class="anchor" aria-label="anchor" href="#data-accessibility"></a>
</h2>
<p>This article does not use any empirical data. The package is
available on Github (SOME KIND OF URL OR DOI REF).</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">REFERENCES<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Cao2019" class="csl-entry">
Cao, Yong, and Charles P. Hawkins. 2019. <span>“<span class="nocase">Weighting effective number of species measures by
abundance weakens detection of diversity responses</span>.”</span>
<em>Journal of Applied Ecology</em>, no. December 2018: 1–10. <a href="https://doi.org/10.1111/1365-2664.13345" class="external-link">https://doi.org/10.1111/1365-2664.13345</a>.
</div>
<div id="ref-Chao2016" class="csl-entry">
Chao, Anne, and Chun Huo Chiu. 2016. <span>“<span class="nocase">Bridging the variance and diversity decomposition
approaches to beta diversity via similarity and differentiation
measures</span>.”</span> <em>Methods in Ecology and Evolution</em> 7
(8): 919–28. <a href="https://doi.org/10.1111/2041-210X.12551" class="external-link">https://doi.org/10.1111/2041-210X.12551</a>.
</div>
<div id="ref-Chao2014b" class="csl-entry">
Chao, Anne, Nicholas J. Gotelli, T. C. Hsieh, Elizabeth L. Sander, K. H.
Ma, Robert K. Colwell, and Aaron M. Ellison. 2014. <span>“<span class="nocase">Rarefaction and extrapolation with Hill numbers: a
framework for sampling and estimation in species diversity
studies</span>.”</span> <em>Ecological Monographs</em> 84 (1): 45–67. <a href="https://doi.org/10.1890/13-0133.1" class="external-link">https://doi.org/10.1890/13-0133.1</a>.
</div>
<div id="ref-Chao2015" class="csl-entry">
Chao, Anne, and Lou Jost. 2015. <span>“<span class="nocase">Estimating
diversity and entropy profiles via discovery rates of new
species</span>.”</span> <em>Methods in Ecology and Evolution</em> 6 (8):
873–82. <a href="https://doi.org/10.1111/2041-21" class="external-link">https://doi.org/10.1111/2041-21</a>.
</div>
<div id="ref-Chao2019a" class="csl-entry">
Chao, Anne, Carlo Ricotta, and Piazzale Aldo. 2019. <span>“<span class="nocase">Quantifying evenness and linking it to diversity, beta
diversity, and similarity</span>.”</span> <em>Ecology</em>, no. 0: 1–15.
<a href="https://doi.org/10.1002/ecy.2852" class="external-link">https://doi.org/10.1002/ecy.2852</a>.
</div>
<div id="ref-Chase2013" class="csl-entry">
Chase, Jonathan M., and Tiffany M. Knight. 2013. <span>“<span class="nocase">Scale-dependent effect sizes of ecological drivers on
biodiversity: Why standardised sampling is not enough</span>.”</span>
<em>Ecology Letters</em> 16 (SUPPL.1): 17–26. <a href="https://doi.org/10.1111/ele.12112" class="external-link">https://doi.org/10.1111/ele.12112</a>.
</div>
<div id="ref-Gelman2014" class="csl-entry">
Gelman, Andrew, and John Carlin. 2014. <span>“<span class="nocase">Beyond Power Calculations: Assessing Type S (Sign) and
Type M (Magnitude) Errors</span>.”</span> <em>Perspectives on
Psychological Science</em> 9 (6): 641–51. <a href="https://doi.org/10.1177/1745691614551642" class="external-link">https://doi.org/10.1177/1745691614551642</a>.
</div>
<div id="ref-Gooriah2021" class="csl-entry">
Gooriah, Leana, Shane A Blowes, Alban Sagouis, Julian Schrader, Dirk N
Karger, Holger Kreft, and Jonathan M Chase. 2021. <span>“<span class="nocase">Synthesis reveals that island species–area relationships
emerge from processes beyond passive sampling</span>.”</span> <em>Global
Ecology and Biogeography</em>, 1–13. <a href="https://doi.org/10.1111/geb.13361" class="external-link">https://doi.org/10.1111/geb.13361</a>.
</div>
<div id="ref-Haegeman2013" class="csl-entry">
Haegeman, Bart, Jerome Hamelin, John Moriarty, Peter Neal, Jonathan
Dushoff, and Joshua S Weitz. 2013. <span>“<span class="nocase">Robust
estimation of microbial diversity in theory and in
practice</span>.”</span> <em>The ISME Journal</em> 7: 1092–1101. <a href="https://doi.org/10.1038/ismej.2013.10" class="external-link">https://doi.org/10.1038/ismej.2013.10</a>.
</div>
<div id="ref-Hurlbert1971" class="csl-entry">
Hurlbert, Stuart H. 1971. <span>“<span class="nocase">The nonconcept of
species diversity: a critique and alternative parameters</span>.”</span>
<em>Ecology</em> 52 (4): 577–86. <a href="https://doi.org/10.2307/1934145" class="external-link">https://doi.org/10.2307/1934145</a>.
</div>
<div id="ref-Jost2006" class="csl-entry">
Jost, Lou. 2006. <span>“<span class="nocase">Entropy and
diversity</span>.”</span> <em>Oikos</em> 113: 363–75. <a href="https://doi.org/10.1111/j.2006.0030-1299.14714.x" class="external-link">https://doi.org/10.1111/j.2006.0030-1299.14714.x</a>.
</div>
<div id="ref-Kvalseth1991" class="csl-entry">
Kvalseth, Tarald O. 1991. <span>“<span class="nocase">Note on biological
diversity, evenness, and homogeneity measures</span>.”</span>
<em>Oikos</em> 62 (1): 123–27. <a href="https://doi.org/10.2307/3545460" class="external-link">https://doi.org/10.2307/3545460</a>.
</div>
<div id="ref-Lande2000" class="csl-entry">
Lande, Russell, Philip J Devries, and Thomas R Walla. 2000. <span>“<span class="nocase">When species accumulation curves intersect : implications
for ranking diversity using small samples</span>.”</span> <em>Oikos</em>
89 (3): 601–5.
</div>
<div id="ref-May2018a" class="csl-entry">
May, Felix, Katharina Gerstner, Daniel J. McGlinn, Xiao Xiao, and
Jonathan M. Chase. 2018. <span>“<span class="nocase">mobsim: An R
package for the simulation and measurement of biodiversity across
spatial scales</span>.”</span> <em>Methods in Ecology and Evolution</em>
9 (6): 1401–8. <a href="https://doi.org/10.1111/2041-210X.12986" class="external-link">https://doi.org/10.1111/2041-210X.12986</a>.
</div>
<div id="ref-Patil2012" class="csl-entry">
Patil, G P, and C Taillie. 1982. <span>“<span class="nocase">Diversity
as a concept and its measurement</span>.”</span> <em>Journal of the
American Statistical Association</em> 77 (379): 548–61. <a href="https://doi.org/10.1080/01621459.1982.10477845" class="external-link">https://doi.org/10.1080/01621459.1982.10477845</a>.
</div>
<div id="ref-Prado2022" class="csl-entry">
Prado, Paulo I, Murilo Dantas Miranda, and Andre Chalom. 2022.
<span>“<span class="nocase">Package ‘sads’</span>.”</span>
</div>
<div id="ref-Roswell2021" class="csl-entry">
Roswell, Michael, Jonathan Dushoff, and Rachael Winfree. 2021.
<span>“<span class="nocase">A conceptual guide to measuring species
diversity</span>.”</span> <em>Oikos</em> 130 (3): 321–38. <a href="https://doi.org/10.1111/oik.07202" class="external-link">https://doi.org/10.1111/oik.07202</a>.
</div>
<div id="ref-Roswell2022b" class="csl-entry">
Roswell, Michael, Tina Harrison, and Mark A. Genung. 2023. <span>“<span class="nocase">Biodiversity–ecosystem function relationships change in
sign and magnitude across the Hill diversity spectrum</span>.”</span>
<em>Philosophical Transactions of the Royal Society B: Biological
Sciences</em> 378 (1881). <a href="https://doi.org/10.1098/rstb.2022.0186" class="external-link">https://doi.org/10.1098/rstb.2022.0186</a>.
</div>
<div id="ref-Sherwin2017" class="csl-entry">
Sherwin, W. B., A. Chao, L. Jost, and P. E. Smouse. 2017. <span>“<span class="nocase">Information theory broadens the spectrum of molecular
ecology and evolution</span>.”</span> <em>Trends in Ecology &amp;
Evolution</em> 32 (12): 948–63. <a href="https://doi.org/10.1016/j.tree.2017.09.012" class="external-link">https://doi.org/10.1016/j.tree.2017.09.012</a>.
</div>
<div id="ref-Smith1977" class="csl-entry">
Smith, Woolcott, and J. Frederick Grassle. 1977. <span>“<span class="nocase">Sampling properties of a family of diversity
measures</span>.”</span> <em>Biometrics</em> 33: 283–92.
</div>
<div id="ref-Tuomisto2010a" class="csl-entry">
Tuomisto, Hanna. 2010. <span>“<span class="nocase">A consistent
terminology for quantifying species diversity? Yes, it does
exist</span>.”</span> <em>Oecologia</em> 164 (4): 853–60. <a href="https://doi.org/10.1007/s00442-010-1812-0" class="external-link">https://doi.org/10.1007/s00442-010-1812-0</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael Roswell, Jonathan Dushoff.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
