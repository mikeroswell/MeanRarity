<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a SAD given diversity and a distributional assumption — fit_SAD • MeanRarity</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Fit a SAD given diversity and a distributional assumption — fit_SAD" />
<meta property="og:description" content="Takes a true richness, an inverse-Simpson diversity, and a distributional
assumption. Fits an optimal SAD given these constraints using
stats::uniroot." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-018C47WP3Y"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-018C47WP3Y');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MeanRarity</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.0000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Estimating_Mean_Rarity.html">Estimating mean rarity</a>
    </li>
    <li>
      <a href="../articles/Gods_estimator.html">Gods estimator of mean rarity</a>
    </li>
    <li>
      <a href="../articles/Using_MeanRarity.html">Using MeanRarity</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a SAD given diversity and a distributional assumption</h1>
    
    <div class="hidden name"><code>fit_SAD.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Takes a true richness, an inverse-Simpson diversity, and a distributional
assumption. Fits an optimal SAD given these constraints using
<code><a href='https://rdrr.io/r/stats/uniroot.html'>stats::uniroot</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>fit_SAD</span><span class='op'>(</span>
  rich <span class='op'>=</span> <span class='fl'>50</span>,
  simpson <span class='op'>=</span> <span class='fl'>40</span>,
  distr <span class='op'>=</span> <span class='st'>"lnorm"</span>,
  int_lwr <span class='op'>=</span> <span class='fl'>1e-04</span>,
  int_uppr <span class='op'>=</span> <span class='fl'>100</span>,
  totAb <span class='op'>=</span> <span class='fl'>1e+07</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>rich</th>
      <td><p>Total number of species in the SAD, an integer.</p></td>
    </tr>
    <tr>
      <th>simpson</th>
      <td><p>Hill-Simpson diversity of the SAD, a real number in
[1,rich].</p></td>
    </tr>
    <tr>
      <th>distr</th>
      <td><p>Name of the distribution (<code>"lnorm"</code> or <code>"gamma"</code>).</p></td>
    </tr>
    <tr>
      <th>int_lwr</th>
      <td><p>Lower bound of search space for <code><a href='https://rdrr.io/r/stats/uniroot.html'>uniroot()</a></code>; default is a
small number close to 0 to deal with potential boundary issues for
<code><a href='https://rdrr.io/r/stats/uniroot.html'>stats::uniroot</a></code> (a scalar).</p></td>
    </tr>
    <tr>
      <th>int_uppr</th>
      <td><p>Upper bound of search space for <code>uniroot</code> (scalar).</p></td>
    </tr>
    <tr>
      <th>totAb</th>
      <td><p>Integer, assumed total # of individuals in hypothetical
community. See details.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>pass arguments to other</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with three elements.</p>
<p><code>distribution_info</code> Contains the name of the distribution and the
fitted shape parameter value.</p>
<p><code>community_info</code> gives richness, Hill-Shannon, and Hill=Simpson
diversity of the SAD.</p>
<p><code>rel_abundances</code> is a vector of relative abundances for each species
in SAD.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The way the SAD is fit, we assume infinite abundance, but finite and fixed
diversity. In particular, richness is fixed. The parametric fits use
continuous distributions. Species abundances are given at evenly spaced
intervals along those continuous distributions. The distributions are
described by a shape parameter (the scale parameter of the lognormal is
fixed), and the value of that parameter is chosen such that the relative
abundances assigned to the species give the target Hill-Simpson diversity.</p>
<p>The parameter <code>totAb</code> is not implemented in the current version of
<code>fit_SAD()</code>, as the function simulates SADs with infinite abundance.
However, it defaults to 1e7, enabling a warning if the rarest species has
relative abundance <code>&lt; (1/totAb)</code>. This can serve as a reality check as
uneven SADs may be fit with species well rarer than 1 in 10 Million. Such
SADs may be inappropriate test cases for non-microbial ecologists.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/uniroot.html'>uniroot</a></code>, <code><a href='MeanRarity-package.html'>MeanRarity</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#works</span>
<span class='fu'>fit_SAD</span><span class='op'>(</span>distr <span class='op'>=</span> <span class='st'>"gamma"</span><span class='op'>)</span> <span class='co'>#works</span>
</div><div class='output co'>#&gt; $distribution_info
#&gt;       distribution   fitted parameter 
#&gt;            "gamma" "3.86289520314416" 
#&gt; 
#&gt; $community_info
#&gt;     richness Hill-Shannon Hill-Simpson 
#&gt;     50.00000     44.29982     40.00000 
#&gt; 
#&gt; $rel_abundances
#&gt;  [1] 0.050977208 0.043067059 0.039210234 0.036585333 0.034570836 0.032923087
#&gt;  [7] 0.031520640 0.030293970 0.029199456 0.028207877 0.027298671 0.026456798
#&gt; [13] 0.025670906 0.024932204 0.024233734 0.023569880 0.022936036 0.022328368
#&gt; [19] 0.021743638 0.021179080 0.020632300 0.020101202 0.019583933 0.019078832
#&gt; [25] 0.018584395 0.018099242 0.017622091 0.017151738 0.016687030 0.016226850
#&gt; [31] 0.015770097 0.015315667 0.014862432 0.014409215 0.013954769 0.013497736
#&gt; [37] 0.013036613 0.012569693 0.012094992 0.011610149 0.011112276 0.010597731
#&gt; [43] 0.010061772 0.009497971 0.008897183 0.008245572 0.007520342 0.006678887
#&gt; [49] 0.005622419 0.003971859
#&gt; </div><div class='input'><span class='fu'>fit_SAD</span><span class='op'>(</span>distr <span class='op'>=</span> <span class='st'>"lnorm"</span>, rich <span class='op'>=</span> <span class='fl'>50</span>, simpson <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='co'>#works</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Rarest species has relative abundance  4.38248906502601e-08 . </span>
#&gt; <span class='warning'>Consider implied community size.</span></div><div class='output co'>#&gt; $distribution_info
#&gt;       distribution   fitted parameter 
#&gt;            "lnorm" "3.56144818681073" 
#&gt; 
#&gt; $community_info
#&gt;     richness Hill-Shannon Hill-Simpson 
#&gt;    50.000000     3.294258     2.000000 
#&gt; 
#&gt; $rel_abundances
#&gt;  [1] 6.888518e-01 1.409222e-01 6.082007e-02 3.330848e-02 2.059171e-02
#&gt;  [6] 1.370931e-02 9.596922e-03 6.966149e-03 5.196934e-03 3.960780e-03
#&gt; [11] 3.070641e-03 2.413851e-03 1.919412e-03 1.540891e-03 1.246962e-03
#&gt; [16] 1.015930e-03 8.324241e-04 6.853386e-04 5.665088e-04 4.698410e-04
#&gt; [21] 3.907249e-04 3.256299e-04 2.718228e-04 2.271666e-04 1.899756e-04
#&gt; [26] 1.589091e-04 1.328930e-04 1.110608e-04 9.270910e-05 7.726371e-05
#&gt; [31] 6.425335e-05 5.328930e-05 4.404955e-05 3.626620e-05 2.971550e-05
#&gt; [36] 2.420993e-05 1.959182e-05 1.572818e-05 1.250651e-05 9.831452e-06
#&gt; [41] 7.621947e-06 5.808974e-06 4.333651e-06 3.145681e-06 2.202070e-06
#&gt; [46] 1.466069e-06 9.063414e-07 4.963634e-07 2.142236e-07 4.382489e-08
#&gt; </div><div class='input'><span class='fu'>fit_SAD</span><span class='op'>(</span>distr <span class='op'>=</span> <span class='st'>"gamma"</span>, rich <span class='op'>=</span> <span class='fl'>50</span>, simpson <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='co'>#works</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Rarest species has relative abundance  2.69995080442289e-83 . </span>
#&gt; <span class='warning'>Consider implied community size.</span></div><div class='output co'>#&gt; $distribution_info
#&gt;         distribution     fitted parameter 
#&gt;              "gamma" "0.0242907270521766" 
#&gt; 
#&gt; $community_info
#&gt;     richness Hill-Shannon Hill-Simpson 
#&gt;    50.000000     2.694709     2.000000 
#&gt; 
#&gt; $rel_abundances
#&gt;  [1] 6.729581e-01 2.005096e-01 7.607360e-02 3.036103e-02 1.219451e-02
#&gt;  [6] 4.850669e-03 1.897665e-03 7.276530e-04 2.729132e-04 9.996717e-05
#&gt; [11] 3.571346e-05 1.242684e-05 4.205614e-06 1.382235e-06 4.404637e-07
#&gt; [16] 1.358457e-07 4.047197e-08 1.162316e-08 3.210401e-09 8.506808e-10
#&gt; [21] 2.156473e-10 5.213926e-11 1.198286e-11 2.607946e-12 5.352530e-13
#&gt; [26] 1.031105e-13 1.854538e-14 3.095739e-15 4.763667e-16 6.704994e-17
#&gt; [31] 8.555806e-18 9.795856e-19 9.942777e-20 8.820577e-21 6.725028e-22
#&gt; [36] 4.318346e-23 2.278772e-24 9.587660e-26 3.096926e-27 7.318875e-29
#&gt; [41] 1.188639e-30 1.220237e-32 7.057474e-35 1.950500e-37 2.010861e-40
#&gt; [46] 5.195004e-44 1.668512e-48 1.608919e-54 1.184325e-63 2.699951e-83
#&gt; </div><div class='input'><span class='fu'>fit_SAD</span><span class='op'>(</span>distr <span class='op'>=</span> <span class='st'>"gamma"</span>, rich <span class='op'>=</span> <span class='fl'>10</span>, simpson <span class='op'>=</span> <span class='fl'>6</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $distribution_info
#&gt;       distribution   fitted parameter 
#&gt;            "gamma" "1.23540540463064" 
#&gt; 
#&gt; $community_info
#&gt;     richness Hill-Shannon Hill-Simpson 
#&gt;    10.000000     7.273506     6.000000 
#&gt; 
#&gt; $rel_abundances
#&gt;  [1] 0.286412672 0.188593616 0.142105917 0.110870935 0.087043180 0.067550896
#&gt;  [7] 0.050836952 0.035950731 0.022158130 0.008476971
#&gt; </div><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'>fit_SAD</span><span class='op'>(</span>distr <span class='op'>=</span> <span class='st'>"nonsense"</span><span class='op'>)</span>  <span class='co'>#returns error</span>
<span class='fu'>fit_SAD</span><span class='op'>(</span>distr <span class='op'>=</span> <span class='st'>"lnorm"</span>, rich <span class='op'>=</span> <span class='fl'>50</span>, simpson <span class='op'>=</span> <span class='fl'>90</span><span class='op'>)</span> <span class='co'>#returns error</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Michael Roswell, Jonathan Dushoff.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


